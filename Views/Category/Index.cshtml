@model IEnumerable<Categoria>

@{
	ViewData["Title"] = "Categorías Index";
	Layout = "~/Views/Shared/_Layout.cshtml";
}

<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>@ViewData["Categorías"]</title>

	<!--Font family-->
	<link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">

	<!-- Bootstrap CSS -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

	<!-- Bootstrap Bundle (incluye Bootstrap JS) -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

	<!-- jQuery (asegúrate de incluirlo antes de los scripts de validación) -->
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

	<!-- jQuery Validate y jQuery Validate Unobtrusive -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/jquery.validate.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validation-unobtrusive/3.2.12/jquery.validate.unobtrusive.min.js"></script>

	<!-- Font Awesome -->
	<script src="https://kit.fontawesome.com/a076d05399.js"></script>
</head>

<body>
	<header id="title">
		<h1 id="title">Categorías</h1>
	</header>

	<div class="inline">
		<form class="filterSearch" method="get" asp-action="Index">
			<input class="form-control me-2" type="search" placeholder="Buscar por nombre" aria-label="Buscar" name="searchString">
			<button class="btn btn-info" type="submit">Buscar</button>
		</form>
	</div>
	<br />
	<div class="inline">
		<a class="btn btn-info w-100" asp-action="Create">Crear</a>
		<a class="btn btn-info w-100" asp-action="Edit">Editar</a>
		<a class="btn btn-info w-100" asp-action="Delete">Eliminar</a>
	</div>

	<!-- Table -->
	<div class="table-responsive">
		<table class="table table-hover">
			<thead>
				<tr>
					<th>Código</th>
					<th>@Html.DisplayNameFor(model => model.FirstOrDefault().Nombre)</th>
					<th>Acciones</th>
				</tr>
			</thead>
			<tbody>
				@foreach (var item in Model)
				{
					<tr>
						<td>@Html.DisplayFor(modelItem => item.IDCategoria)</td>
						<td>@Html.DisplayFor(modelItem => item.Nombre)</td>
						<td>
							<div class="dropdown">
								<button class="btn btn-primary dropdown-toggle" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
									<i class="bi bi-three-dots"></i>
								</button>
								<ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
									<li><a class="dropdown-item" asp-action="Edit" asp-route-id="@item.IDCategoria">Editar</a></li>
									<li><a class="dropdown-item" href="#">Habilitar</a></li>
									<li><a class="dropdown-item" href="#">Deshabilitar</a></li>
								</ul>
							</div>
						</td>
					</tr>
				}
			</tbody>
		</table>
	</div>
	</div>
	</div>
</body>


@section Scripts {
	<script>
		$(document).ready(function () {
			$('.dropdown-menu a.dropdown-item').click(function () {
				var option = $(this).text().trim();
				var categoryId = $(this).closest('tr').find('td:first').text().trim(); // Obtener el ID de la categoría

				if (option === 'Editar') {
					// Redirigir a la página de edición (reemplazar con la URL correcta)
					window.location.href = '@Url.Action("Edit", "Category", new { id = "__categoryId__" })'.replace('__categoryId__', categoryId);
				} else if (option === 'Habilitar') {
					// Lógica para habilitar la categoría (puedes hacer una solicitud AJAX aquí)
					console.log('Habilitar categoría con ID: ' + categoryId);
				} else if (option === 'Deshabilitar') {
					// Lógica para deshabilitar la categoría (puedes hacer una solicitud AJAX aquí)
					console.log('Deshabilitar categoría con ID: ' + categoryId);
				}
			});
		});
	</script>

	@* Incluir los scripts de validación si es necesario *@
	@{
		await Html.RenderPartialAsync("_ValidationScriptsPartial");
	}

}

<style>

	html {
		font-family: "Montserrat", sans-serif;
	}

	header {
		background-color: #1A2130;
		color: white;
		padding: 1rem 2rem 2rem 2rem;
		width: 100%;
		h1

	{
		font-size: 3rem;
		text-align: left;
	}

	}

	.filterSearch {
		width: 60%;
		padding: 1rem 1rem;
		display: inline;
	}

	.inline {
		margin: 2cm 0;
		display: inline;
		padding: 0rem 2rem;
	}

	.btn btn-info w-100 {
		padding: 1rem 2rem;
	}

</style>
